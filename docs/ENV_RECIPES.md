# 환경 조합법 쉽게 이해하기

이 문서는 누구나 이해할 수 있게, “환경 조합법(Recipe)”을 아주 쉽게 설명해요.

## 환경 조합법이란?
- 땅과 공기의 **상태를 섞는 레시피**예요.
- 예를 들면 **온도**, **습도**, **수분(토양 물)**, **빛(햇빛)**, **바람** 같은 값들을 섞어서
  - “따뜻하고 촉촉한 숲”,
  - “건조하고 뜨거운 사막”,
  - “추운 고산지대”
  같은 **분위기**를 만들 수 있어요.

## 왜 10억 개 이상이야?
- 값들을 조금씩만 바꿔도 **새로운 조합**이 끝없이 나와요.
- 온도 25도 vs 26도, 습도 60% vs 65%처럼 **조금의 차이**도 다른 레시피예요.
- 그래서 **10억 개 이상**의 레시피가 가능한 거예요.

## 장소(Place)와 레시피
- **장소(노드)**는 “우리 동네는 이런 분위기!” 하고 **레시피를 들고 있어요.**
- 예: “타입 2(사막) + 타입 3(고산)를 섞어서 **고산 사막**!”
- 이 레시피는 **주변 땅(그리드)**에 퍼져서 그 동네만의 날씨가 만들어져요.

## 값들이 서로 반응해요
- **더우면** 물이 **증발**해요 → 공기 **습도**가 올라가요.
- 습도가 높으면 **비**가 와요 → **온도**가 내려가요.
- 이렇게 **자연스러운 사이클**이 자동으로 생겨요.

## 컴퓨터가 힘들지 않게 하는 방법
- 마인크래프트처럼 **필요한 곳만** 만들어요. (청크 시스템)
- 멀리 있는 빈 곳은 **아무것도 만들지 않아요.**
- 그래서 **렉 없이** 돌아갈 수 있어요.

## 더 알고 싶다면
- README의 [환경 그리드](../README.md#23-환경-그리드-environment-grid)를 읽어보세요.

## 개발자가 보는 구조 (요약)
- **레시피 정의**: `src/core/environment/environmentRecipes.ts`
  - `EnvironmentRecipeId` 타입과 여러 기본 레시피(숲, 사막, 고산, 습지 등)를 정의해요.
  - 각 레시피는 `EnvironmentLayer`별 기본 값을 들고 있어요.
- **장소가 레시피를 들고 있음**:
  - `src/components/entityData.ts` → `PlaceData.environmentRecipeId`
  - `src/core/maze/placeNode.ts` → `PlaceComponent`가 기본값으로 `'forest'`를 사용해요.
- **장소 생성 시 레시피 적용**:
  - `src/core/maze/mazeNetwork.ts` → `MazeSystem`이 `createNode`로 Place를 만들고,
    `applyPlaceEnvironment`를 통해 `NatureSystem`에 레시피 적용을 요청해요.
- **레시피가 실제 그리드에 뿌려지는 곳**:
  - `src/core/environment/natureSystem.ts`
    - `initializeWorld(recipeId)`에서 시작 구역 전체를 하나의 레시피 기반으로 초기화해요.
    - `applyRecipeAt(x, y, recipeId, radius)`에서 특정 장소 주변에 레시피를 원형 영역으로 적용해요.
